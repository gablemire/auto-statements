service: auto-receipt

provider:
  name: google
  stage: production
  runtime: nodejs12
  region: us-east1
  project: auto-receipt-prod
  credentials: ./.gcloud/keyfile.production.json
  memorySize: 256
  labels:
    environment: ${self:provider.stage}
  environment:
    AUTH_JWT_JWKS_URL: ${file(./.gcloud/secrets.prod.yml):auth.jwt.jwksUrl}
    AUTH_JWT_AUDIENCE: ${file(./.gcloud/secrets.prod.yml):auth.jwt.audience}
    AUTH_JWT_ISSUER: ${file(./.gcloud/secrets.prod.yml):auth.jwt.issuer}
    NODE_ENV: production
    FUNCTION_REGION: ${self:provider.region}
    CORR_NO_MAILING_ADDR_SUBJECT: ${file(./.gcloud/secrets.prod.yml):correspondence.no-mailing-addr.subject}
    CORR_THANK_YOU_SUBJECT: ${file(./.gcloud/secrets.prod.yml):correspondence.thank-you.subject}
    SENDGRID_API_KEY: ${file(./.gcloud/secrets.prod.yml):sendGrid.apiKey}
    EMAIL_FROM: ${file(./.gcloud/secrets.prod.yml):sendGrid.from}
    EMAIL_REPLY_TO: ${file(./.gcloud/secrets.prod.yml):sendGrid.replyTo}

plugins:
  - serverless-google-cloudfunctions

package:
  exclude:
    - ./**
  include:
    - lib/**
    - config/**
    - package.json
    - package-lock.json

functions: ${file(./serverless/functions.yml):functions}
